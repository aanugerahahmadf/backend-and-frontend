(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let t="http://127.0.0.1:8000/api/v1",s=async(e,t={})=>{try{let s=await fetch(e,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(t){throw console.error(`API request failed: ${e}`,t),t}};e.s(["api",0,{getStats:async()=>s(`${t}/stats`),getBuildings:async()=>s(`${t}/buildings`),getBuilding:async e=>s(`${t}/buildings/${e}`),getRooms:async()=>s(`${t}/rooms`),getRoomsByBuilding:async e=>s(`${t}/rooms/building/${e}`),getRoom:async e=>s(`${t}/rooms/${e}`),getCctvs:async()=>s(`${t}/cctvs`),getCctvsByRoom:async e=>s(`${t}/cctvs/room/${e}`),getCctv:async e=>s(`${t}/cctvs/${e}`),getCctvStreamUrl:async e=>s(`${t}/cctvs/${e}/stream-url`),getContacts:async()=>s(`${t}/contacts`)}])},78716,e=>{"use strict";let t=(0,e.i(75254).default)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);e.s(["Video",()=>t],78716)},67585,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let l=e.r(32061);function r({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new l.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},9885,(e,t,s)=>{"use strict";function l(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return l}})},52157,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return i}});let l=e.r(43476),r=e.r(74080),n=e.r(63599),a=e.r(9885);function i({moduleIds:e}){if("undefined"!=typeof window)return null;let t=n.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let l=t.reactLoadableManifest;for(let t of e){if(!l[t])continue;let e=l[t].files;s.push(...e)}}return 0===s.length?null:(0,l.jsx)(l.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,a.encodeURIPath)(e)}`;return e.endsWith(".css")?(0,l.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,r.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},69093,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return d}});let l=e.r(43476),r=e.r(71645),n=e.r(67585),a=e.r(52157);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},s=(0,r.lazy)(()=>t.loader().then(i)),d=t.loading;function c(e){let i=d?(0,l.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,c=o?r.Suspense:r.Fragment,u=t.ssr?(0,l.jsxs)(l.Fragment,{children:["undefined"==typeof window?(0,l.jsx)(a.PreloadChunks,{moduleIds:t.modules}):null,(0,l.jsx)(s,{...e})]}):(0,l.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,l.jsx)(s,{...e})});return(0,l.jsx)(c,{...o?{fallback:i}:{},children:u})}return c.displayName="LoadableComponent",c}},70703,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return r}});let l=e.r(55682)._(e.r(69093));function r(e,t){let s={};"function"==typeof e&&(s.loader=e);let r={...s,...t};return(0,l.default)({...r,modules:r.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},50704,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(70703),r=e.i(78716),n=e.i(37727),a=e.i(54858);let i=(0,l.default)(()=>e.A(52169).then(e=>e.MapContainer),{loadableGenerated:{modules:[94970]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-950/30 to-slate-900/30 flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-white/50 font-semibold",children:"Loading map..."})})}),o=(0,l.default)(()=>e.A(52169).then(e=>e.TileLayer),{loadableGenerated:{modules:[94970]},ssr:!1}),d=(0,l.default)(()=>e.A(52169).then(e=>e.Marker),{loadableGenerated:{modules:[94970]},ssr:!1}),c=(0,l.default)(()=>e.A(52169).then(e=>e.Popup),{loadableGenerated:{modules:[94970]},ssr:!1});function u(){let[e,l]=(0,s.useState)([]),[u,m]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),[f,p]=(0,s.useState)(null),[b,g]=(0,s.useState)(!0),[j,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{y(!0),v()},[]);let v=async()=>{try{let e=await a.api.getBuildings();l(e)}catch(e){console.error("Failed to fetch buildings:",e)}finally{g(!1)}},w=async e=>{try{m(e),h(!0);let t=await a.api.getCctvStreamUrl(e.id);p(t)}catch(e){console.error("Failed to fetch stream URL:",e)}};return(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&(h(!1),p(null))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,t.jsxs)("main",{className:"bg-gradient-to-br from-blue-950 via-slate-900 to-blue-950 py-8 min-h-[calc(100vh-140px)] flex flex-col",children:[(0,t.jsx)("div",{className:"pt-4 pb-6 px-4",children:(0,t.jsx)("h1",{className:"text-3xl md:text-4xl font-semibold text-white text-center",children:"Maps"})}),(0,t.jsx)("div",{className:"px-4 pb-6 flex-grow",children:(0,t.jsx)("div",{className:"h-[50vh] sm:h-[60vh] md:h-[70vh] w-full rounded-2xl overflow-hidden shadow-2xl z-0",children:j&&!b?(0,t.jsxs)(i,{center:[-6.1751,108.2146],zoom:13,style:{height:"100%",width:"100%"},className:"z-0",children:[(0,t.jsx)(o,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.map(e=>(0,t.jsx)(d,{position:[e.latitude,e.longitude],children:(0,t.jsx)(c,{children:(0,t.jsxs)("div",{className:"p-2 max-w-xs",children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e.rooms?.length||0," Rooms"]}),(0,t.jsx)("div",{className:"mt-2 max-h-60 overflow-y-auto",children:e.rooms?.map(e=>(0,t.jsxs)("div",{className:"mb-2 p-2 border rounded",children:[(0,t.jsx)("h4",{className:"font-semibold",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:[e.cctvs?.length||0," CCTVs"]}),(0,t.jsx)("div",{className:"mt-1 grid grid-cols-1 gap-1",children:e.cctvs?.map(e=>(0,t.jsxs)("button",{onClick:()=>w(e),className:"w-full bg-red-600 hover:bg-red-700 text-white text-xs font-semibold py-1 px-2 rounded flex items-center justify-center gap-1",children:[(0,t.jsx)(r.Video,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:e.name})]},`cctv-${e.id}`))})]},`room-${e.id}`))})]})})},`building-${e.id}`))]}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-950/30 to-slate-900/30 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-3"}),(0,t.jsx)("p",{className:"text-white/50 font-semibold",children:"Loading map..."})]})})})}),x&&u&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-blue-950 border border-white/20 rounded-2xl w-full max-w-3xl max-h-[80vh] flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-white/10",children:[(0,t.jsxs)("h2",{className:"text-lg md:text-xl font-semibold text-white flex items-center gap-2",children:[(0,t.jsx)(r.Video,{className:"w-5 h-5 text-red-400"}),(0,t.jsx)("span",{className:"truncate max-w-[200px] sm:max-w-xs",children:u.name})]}),(0,t.jsx)("button",{onClick:()=>{h(!1),p(null)},className:"text-white/70 hover:text-white transition p-1","aria-label":"Close",children:(0,t.jsx)(n.X,{className:"w-6 h-6"})})]}),(0,t.jsx)("div",{className:"aspect-video bg-black/50 flex items-center justify-center flex-grow relative",children:f?(0,t.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-black",children:(0,t.jsxs)("div",{className:"text-center p-4",children:[(0,t.jsx)(r.Video,{className:"w-16 h-16 text-white/30 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-white/50 font-semibold text-lg",children:"Live Stream Player"}),(0,t.jsx)("p",{className:"text-white/30 text-sm mt-2",children:"Stream connection established"}),(0,t.jsxs)("div",{className:"mt-6 text-xs text-white/40 space-y-1",children:[(0,t.jsxs)("p",{children:["Camera: ",u.name]}),(0,t.jsxs)("p",{children:["Location: ",u.room?.name," - ",u.room?.building?.name]}),(0,t.jsxs)("p",{className:"mt-2 text-green-400/80",children:["Status: ",f.note||"Active"]})]})]})}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 p-2 text-white/80 text-xs",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("span",{className:"bg-blue-500/20 px-2 py-1 rounded",children:"Connection: Secure"}),(0,t.jsxs)("span",{className:"bg-green-500/20 px-2 py-1 rounded",children:["Status: ",f.note||"Active"]})]})})]}):(0,t.jsxs)("div",{className:"text-center p-4",children:[(0,t.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-3"}),(0,t.jsx)("p",{className:"text-white/50 font-semibold",children:"Loading stream..."})]})}),(0,t.jsxs)("div",{className:"p-4 border-t border-white/10 flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{h(!1),p(null)},className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition",children:"Close"}),(0,t.jsxs)("button",{className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition flex items-center gap-2",children:[(0,t.jsx)(r.Video,{className:"w-4 h-4"}),"Full Screen"]})]})]})})]})}e.s(["default",()=>u])},52169,e=>{e.v(t=>Promise.all(["static/chunks/9e166b76034126ad.js"].map(t=>e.l(t))).then(()=>t(94970)))}]);